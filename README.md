# ematm0061-lab-4-solved
**TO GET THIS SOLUTION VISIT:** [EMATM0061 Lab 4 Solved](https://www.ankitcodinghub.com/product/ematm0061-lab-4-solved/)


---

üì© **If you need this solution or have special requests:** **Email:** ankitcoding@gmail.com  
üì± **WhatsApp:** +1 419 877 7882  
üìÑ **Get a quote instantly using this form:** [Ask Homework Questions](https://www.ankitcodinghub.com/services/ask-homework-questions/)

*We deliver fast, professional, and affordable academic help.*

---

<h2>Description</h2>



<div class="kk-star-ratings kksr-auto kksr-align-center kksr-valign-top" data-payload="{&quot;align&quot;:&quot;center&quot;,&quot;id&quot;:&quot;93049&quot;,&quot;slug&quot;:&quot;default&quot;,&quot;valign&quot;:&quot;top&quot;,&quot;ignore&quot;:&quot;&quot;,&quot;reference&quot;:&quot;auto&quot;,&quot;class&quot;:&quot;&quot;,&quot;count&quot;:&quot;0&quot;,&quot;legendonly&quot;:&quot;&quot;,&quot;readonly&quot;:&quot;&quot;,&quot;score&quot;:&quot;0&quot;,&quot;starsonly&quot;:&quot;&quot;,&quot;best&quot;:&quot;5&quot;,&quot;gap&quot;:&quot;4&quot;,&quot;greet&quot;:&quot;Rate this product&quot;,&quot;legend&quot;:&quot;0\/5 - (0 votes)&quot;,&quot;size&quot;:&quot;24&quot;,&quot;title&quot;:&quot;EMATM0061 Lab 4 Solved&quot;,&quot;width&quot;:&quot;0&quot;,&quot;_legend&quot;:&quot;{score}\/{best} - ({count} {votes})&quot;,&quot;font_factor&quot;:&quot;1.25&quot;}">

<div class="kksr-stars">

<div class="kksr-stars-inactive">
            <div class="kksr-star" data-star="1" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="2" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="3" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="4" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="5" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
    </div>

<div class="kksr-stars-active" style="width: 0px;">
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
    </div>
</div>


<div class="kksr-legend" style="font-size: 19.2px;">
            <span class="kksr-muted">Rate this product</span>
    </div>
    </div>
<div class="page" title="Page 1">
<div class="layoutArea">
<div class="column">
This document describes your fourth assignment for Statistical Computing and Empirical Methods (Unit EMATM0061) on the MSc in Data Science. Before starting the assignment it is recommend that you first watch video lectures 9 and 10.

You are encouraged to discuss these questions with your colleagues.

Begin by creating an Rmarkdown document with html output. You are not expected to hand in this piece of work, but it is a good idea to get used to using Rmarkdown.

Several optional extra questions have also been included. These are marked by stars (‚Äò*‚Äú). It is recom- mended that you first complete all unstarred questions before proceeding through the starred questions. Do not be concerned if you do not have time to complete the starred questions!

1 Bayes theorem

Let A be the event that it rains next week and B the event that the weather forecaster predicts that there will be rain next week. Let‚Äôs suppose that the probability of rain next week is P(A) = 0.9. Suppose also that the conditional probability that there is a forecast of rain, given that it really does rain, is P(B|A) = 0.8. On the other hand, the conditional probability that there is a forecast of dry weather, given that there really isn‚Äôt any rain is P(Bc|Ac) = 0.75.

Now suppose that there is a forecast of rain. What is the conditional probability of rain, given the forecast of rain P(A|B)?

2 Conditional probabilities

Suppose we have a probability space (Œ©,E,P).

1. Suppose that A,B ‚àà E and A ‚äÜ B. Give an expression for P(A|B) in terms of P(A) and P(B). What

about when P(A \ B) = 0?

2. Suppose that A, B ‚àà E with A‚à©B = ‚àÖ. Give an expression for P(A|B). What about when P(A‚à©B) = 0? 3. Suppose that A, B ‚àà E with B ‚äÜ A. Give an expression for P(A|B). What about when P(B \ A) = 0?

</div>
</div>
<div class="layoutArea">
<div class="column">
1

</div>
</div>
</div>
<div class="page" title="Page 2">
<div class="layoutArea">
<div class="column">
4. Suppose that A ‚àà E. Give an expression for P(A|Œ©) in terms of P(A).

5. ShowthatgiventhreeeventsA,B,C‚ààE wehaveP(A‚à©B‚à©C)=P(A|B‚à©C)¬∑P(B|C)¬∑P(C).

6. Show that given three events A, B, C ‚àà E we have P(A|B ‚à© C) = P(B|A‚à©C)¬∑P(A|C) . P(B|C)

3 Sampling with replacement

Recall that for positive integers n and k, Ùè∞ÖnÙè∞Ü = n! gives the number of subsets of size k from a set of k k!(n‚àík)!

n objects.

You can compute this number straightforwardly within R via the choose function choose( ). For example,

if we want to compute the number of different subsets of size 3 from a collection of size 8 we would compute:

choose(8,3)

## [1] 56

Suppose we have a bag containing 10 spheres. This includes 3 red spheres and 7 blue spheres.

Let‚Äôs suppose that we draw a sphere at random from the bag (all spheres have equal probability of being drawn). We record its colour and then return the sphere to the bag. This process is repeated 35 times. This is an example of sampling with replacement since the spheres are replaced after each draw.

Write down a mathematical expression for the probability that z out of the 35 selections were red spheres (here z ‚àà {1,‚Ä¶,35}).

Try doing this with in laTex, making use of the laTex functions binom{}{} and frac{}{}.

Next write an R function called prob_red_spheres() which takes z as an argument and computes the probability that z out of a total of the 35 balls selected are red.

Test your function as follows:

<pre>prob_red_spheres(20)
</pre>
<pre>## [1] 0.0005376555
</pre>
Generate a data frame called prob_by_num_reds with two columns num_reds and prob. The num_reds column should contain numbers 1 through 35 and the prob column should give the associated probability of selecting that many reds out of a total number of 35 selections.

Display the first 3 rows of your data frame:

<pre>prob_by_num_reds%&gt;%head(3)
</pre>
</div>
</div>
<div class="layoutArea">
<div class="column">
## ## 1 ## 2 ## 3

</div>
<div class="column">
<pre>num_reds         prob
       1 0.0000568228
       2 0.0004139947
       3 0.0019516894
</pre>
</div>
</div>
<div class="layoutArea">
<div class="column">
2

</div>
</div>
</div>
<div class="page" title="Page 3">
<div class="section">
<div class="layoutArea">
<div class="column">
Now use the geom_line() function within the ggplot2 library, in conjunction with your data frame to display a plot of the probability as a function of the number of reds. Your plot should look as follows:

</div>
</div>
<div class="section">
<div class="layoutArea">
<div class="column">
0.15

0.10

0.05

0.00

</div>
</div>
<div class="layoutArea">
<div class="column">
0 10 20 30

Number of reds

</div>
</div>
</div>
<div class="layoutArea">
<div class="column">
Next we shall explore the sample() function within R. Let‚Äôs suppose we want to simulate a random experi- ment in which we sample with replacement from a collection of 10 objects, and repeat this process 35 times. We can do this by calling:

<pre>sample(10,35,replace=TRUE)
</pre>
Try this out for yourself. The output should be a vector of length 35 consisting entirely of numbers between 1 and 10. Since this is sampling with replacements and the number of samples exceeds the number of elements there will be repetitions.

Try rerunning the function. You probably get a different sample. This is to be expected, and even desirable, since the function simulates a random sample. However, the fact that we get a different answer every time we run the code is problematic from the prespective of reproducibility. To avoid this process we can set a random seed via the function set.seed(). By doing so we should get the same output every time. Try the following out for your self:

</div>
</div>
<div class="section">
<div class="layoutArea">
<div class="column">
<pre>## Setting the random seed just once
</pre>
set.seed(0) for(i in 1:5){

<pre>  print(sample(100,5,replace=FALSE))
</pre>
</div>
</div>
</div>
<div class="layoutArea">
<div class="column">
3

</div>
</div>
</div>
<div class="section">
<div class="layoutArea">
<div class="column">
Probability

</div>
</div>
</div>
</div>
<div class="page" title="Page 4">
<div class="section">
<div class="layoutArea">
<div class="column">
<pre>  # The result may well differ every time
</pre>
}

<pre>## Resetting the random seed every time
</pre>
for(i in 1:5){

set.seed(1) print(sample(100,5,replace=FALSE)) # The result should not change

}

</div>
</div>
</div>
<div class="layoutArea">
<div class="column">
We shall now use the sample() to construct a simulation study to explore the probability of selecting z red balls from a bag of size 10, with 3 red and 7 blue balls, when sampling 35 balls with replacement.

First set a random seed. Then create a data frame called sampling_with_replacement_simulation con- sisting of a two columns. The first is called trial and contains numbers 1 through 1000. The second is called sample_balls and corresponds to a random sample of size 35 from a bag of size 10, with replacement. We can do this as follows:

Now add a new column called num_reds such that, for each row, num_reds contains an integer which gives the number of items within the sample for that row (the entry in the sample_balls column) which are less than or equal to three. For example, suppose that some row of the data frame, the sample_balls column contains the following list:

<pre>9, 4, 7, 1, 2, 7, 2, 3, 1, 5, 5, 10, 6, 10, 7, 9, 5, 5, 9, 9,
5, 5, 2, 10, 9, 1, 4, 3, 6, 10, 10, 6, 4, 4, 10
</pre>
Then the corresponding row of the num_reds column should contain the number 8, since 8 of these values are less than equal to 3. You may want to use the functions mutate(), map_dbl and sum().

Next we shall add a new column called simulation_count to our existing data frame prob_by_num_reds which gives the number of times within our simulation we observed the corresponding number of reds. We can do this as follows:

</div>
</div>
<div class="section">
<div class="layoutArea">
<div class="column">
num_trials&lt;-1000 # set the number of trials set.seed(0) # set the random seed

sampling_with_replacement_simulation&lt;-data.frame(trial=1:num_trials)%&gt;% mutate(sample_balls=map(.x=trial,~sample(10,35,replace = TRUE)))

# generate collection of num_trials simulations

</div>
</div>
</div>
<div class="section">
<div class="layoutArea">
<div class="column">
num_reds_in_simulation&lt;-sampling_with_replacement_simulation%&gt;%pull(num_reds) # we extract a vector corresponding to the number of reds in each trial

prob_by_num_reds&lt;-prob_by_num_reds%&gt;% mutate(simulation_count=map_dbl(.x=num_reds,~sum(num_reds_in_simulation==.x))) # add a column which gives the number of trials with a given number of reds

</div>
</div>
</div>
<div class="layoutArea">
<div class="column">
4

</div>
</div>
</div>
<div class="page" title="Page 5">
<div class="section">
<div class="layoutArea">
<div class="column">
Next we add a column called expected_count corresponding to the expected number of observed reds in 1000 based upon your probability formula.

Finally, create a plot which compares the results of your simulation with the expected count based on your probability formula. The concept of expectation will be discussed in Lecture 11.

Your result should look something like the plot below. Of course, since this is a random simulation, your result may well look slightly different.

</div>
</div>
<div class="section">
<div class="layoutArea">
<div class="column">
prob_by_num_reds&lt;-prob_by_num_reds%&gt;% mutate(expected_count=num_trials*prob)

# add a column which gives the expected number of reds # based on the probability formula

</div>
</div>
</div>
<div class="section">
<div class="layoutArea">
<div class="column">
<pre>prob_by_num_reds%&gt;%
  rename(Simulation=simulation_count,Expected=expected_count)%&gt;%
  pivot_longer(cols=c("Simulation","Expected"),
</pre>
<pre>               names_to="Type",values_to="count")%&gt;%
  ggplot(aes(num_reds,count)) +
</pre>
<pre>    geom_line(aes(linetype=Type, color=Type)) +
</pre>
<pre>    scale_linetype_manual(values = c("solid", "dashed"))+
  theme_bw()+
  xlab("Number of reds")+
  ylab("Count")
</pre>
</div>
</div>
</div>
<div class="section">
<div class="layoutArea">
<div class="column">
150

100

50

0

</div>
</div>
<div class="layoutArea">
<div class="column">
0 10 20 30

Number of reds

</div>
</div>
<div class="layoutArea">
<div class="column">
Type Expected

Simulation

</div>
</div>
</div>
<div class="layoutArea">
<div class="column">
5

</div>
</div>
</div>
<div class="section">
<div class="layoutArea">
<div class="column">
Count

</div>
</div>
</div>
</div>
<div class="page" title="Page 6">
<div class="layoutArea">
<div class="column">
Try to make sense of each line in the above code.

Notice the close relationship between probabilities and long-run frequency behaviour. We shall explore this connection over the next few lectures.

4 Sampling without replacement

This question is more challenging. However, you should aim to complete at least the simulation component using ideas from the previous question.

Let‚Äôs suppose we have large bag containing 100 spheres. There are 50 red spheres, 30 blue spheres and 20 green spheres. Suppose that we sample 10 spheres from the bag without replacement.

What is the probability that one or more colours is missing from your selection?

First aim to answer this question via a simulation study using ideas from the previous question. You may want to use the following steps:

<ol>
<li>First set a random seed;</li>
<li>Next set a number of trials, a number of reds, a number of blues, a number of greens and a sample
size;
</li>
<li>Now use a combination of the functions sample(), mutate() and map() to generate your samples.
Here you are creating sample of size 10 from a collection of 100 balls ‚Äì the sampling is done without

replacement;
</li>
<li>Now compute the number of ‚Äúreds‚Äù, ‚Äúgreens‚Äù and ‚Äúblues‚Äù in your sample using the map_dbl() and
mutate() functions;
</li>
<li>Compute the minimum of the three counts using the pmin() function. When this minimum is zero,
then one of the three colours is missing. It is recommended that you look up the difference between

pmin() and min() here;
</li>
<li>Compute the proportion of rows for which the minimum number of the three counts is zero.</li>
</ol>
Try this initially with a small number of simulations. Increase your number of simulations to about a relatively large number to get a more accurate answer, once everything seems to be working well.

The next part of the question is more challenging and may be omitted if you are short on time.

(*) Once you have a simulation based answer you can try and use ‚Äúcombinations‚Äù with Ùè∞ÖnÙè∞Ü to compute the

k

probability directly. First aim and compute the number of subsets of size 10 from 100 which either entirely miss out one of the subsets Reds = {1,‚Ä¶,50}, Blues = {51,‚Ä¶,80}, Greens = {81,‚Ä¶,100}. Be careful not to double count some of these subsets! Once you have computed all such subsets combine with the formula for the total number of subsets of size 10 from a set of 100, to compute the probability of missing a colour.

</div>
</div>
<div class="layoutArea">
<div class="column">
6

</div>
</div>
</div>
<div class="page" title="Page 7">
<div class="layoutArea">
<div class="column">
5 Mutual independence and pair-wise independent

Consider a simple probability space (Œ©, E , P) with Œ© = {(0, 0, 0), (0, 1, 1), (1, 0, 1), (1, 1, 0)}. Since (Œ©,E,P) is a simple probability space containing four elements we have

P({(0,0,0)}) = P({(0,1,1)}) = P({(1,0,1)}) = P({(1,1,0)}) = 41.

Consider the events A := {(1,0,1),(1,1,0)}, B := {(0,1,1),(1,1,0)} and C := {(0,1,1),(1,0,1)}.

VerifythatP(A‚à©B)=P(A)¬∑P(B),P(A‚à©C)=P(A)¬∑P(C)andP(B‚à©C)=P(B)¬∑P(C). Hence,wededuce that the events A, B, C are pair-wise independent.

What is A‚à©B‚à©C? What is P(A‚à©B‚à©C)?

Are the events A,B,C mutually independent?

6 The Monty hall problem (*)

Consider the following game:

At a game show there are three seemingly identical doors. Behind one of the doors is a car, and behind the remaining two is a goat. The contestant of the game first gets to choose one of the three doors. The host then opens one of the other two doors to reveal a goat. The contestant now get‚Äôs a chance to either (a) switch their choice to the other unopened door or (b) stick to their original choice. The host then opens the door corresponding to the contestant‚Äôs final choice. They get to keep whatever is behind their final choice of door.

Does the contestant improve their chances of winning the car if they switch their choice? For clarity, we make the following assumptions:

<ol>
<li>The car is assigned to one of the doors at random with equal probability for each door.</li>
<li>The assignment of the car and the initial choice of the contestant are independent.</li>
<li>Once the contestant makes their initial choice, the host always opens a door which (a) has a goat
behind it and (b) is not the contestant‚Äôs initial choice. If there is more than one such door (i.e. when the contestant‚Äôs initial choice corresponds to the door with a car behind it) the host chooses at random from the two possibilities with equal probability.
</li>
</ol>
To formalise our problem we introduce the following events for i = 1, 2, 3:

‚Ä¢ Ai denotes event car is placed behind the i-th door;

‚Ä¢ Bi denotes event contestant initially chooses the i-th door;

‚Ä¢ Ci denotes event the host opens the i-th door to reveal a goat.

Consider a situation in which the contestant initially selects the first door (B1) and then the host opens the second door to reveal a goat (C2). What is P(A3|B1 ‚à© C2)?

What does this suggest about a good strategy? Should we switch choices? 7

</div>
</div>
</div>
<div class="page" title="Page 8">
<div class="layoutArea">
<div class="column">
7 A game of marbles (**)

This question is left as an optional challenge for those who have completed all remaining questions.

Suppose there two players ‚Äì A and B. Player A has n marbles and player B has k ‚àí n marbles (n ‚â§ k), so the two players have k marbles between them. The game proceeds through a series of rounds. In each round A has probability p of winning the round, and B has probability 1 ‚àí p of winning the round, where p ‚àà (0,1/2) is a fixed number. If A wins a round then B must give A one of his marbles. If B wins the round then A must give B one of his marbles. All of the rounds are independent from one another. A player wins the entire game of marbles when they have all k marbles, and the other player has none.

Can you give a formula for the probability that player A wins the game in terms of n and k and p? If you have completed all the questions on this assignment email henry.reeve@bristol.ac.uk.

</div>
</div>
<div class="layoutArea">
<div class="column">
8

</div>
</div>
</div>
